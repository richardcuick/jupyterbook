# 工况判断

T = ( V井 — V柱 ) / 60 × Q

* V井：井筒容积 ( 升 )
* V柱：钻柱体积 ( 升 )
* Q：钻井液排量 ( 升 / 秒 )
* T：循环一周的时间 ( 分 )

V井 = π x ( 外径 ^ 2 - 内径 ^ 2 ) x 高度

井筒容积根据井筒图进行计算

钻柱内外总容积 V V1 + V2

* V：钻柱内外容积 ( m3 )
* V1：钻柱内容积 ( m3 )
* V2：钻柱与裸眼环空容积 ( m3 )

计算注入压井液的时间 t = t1 + t2

压井液从地面到钻头所需的时间为 t1：

* V1：钻具容积系数 ( L / m )
* H1：钻具长度 ( m )
* Q：压井排量 ( L / s )

压井排量 = 单位泵冲体积 × 泵冲频率

单位泵冲体积是指每个泵冲所泵送的压井液体积，通常以 升 / 冲 为单位。

泵冲频率是指每分钟的泵冲次数，通常以 冲 / 分钟 为单位。

压井液充满环空的时间为 t2 ：
 
式中：V2 — 环空容积系数 ( L / m )。

通过计算注入压井液的时间（ t ）与实际时间的比较，和环空液面高度变化情况，来判别工况发生了溢流或者漏失。

如果注入压井液的时间（ t ）明显超出预期时间，并且环空液面高度下降较快，这可能表明存在井漏失的情况。井漏失会导致压力下降，使得注入压井液的时间延长，并且环空液面高度会随着液体从井中流失而下降。

另一方面，如果注入压井液的时间（ t ）明显短于预期时间，并且环空液面高度上升较快，可能表明存在井口溢流的情况。井口溢流会导致压井液无法有效封堵井口，使得注入压井液的时间缩短，并且环空液面高度会随着溢流而上升。

液面高度变化：采用最小二乘法计算液面变化斜率

假设液面高度数据为 y1 , y2 , y3 , ... , y10

假设数据的间隔为1秒，自变量可以表示为 x = [ 1 , 2 , 3 , ... , 10 ] ，对应于每个数据点的时间

计算平均值：计算液面高度数据的平均值，表示为 y_mean = ( y1 + y2 + y3 + ... + y10 ) / 10

计算斜率：使用最小二乘法来计算斜率。斜率可以通过以下公式计算：

斜率 ( k ) = Σ ( ( x - x_mean ) x ( y - y_mean ) ) / Σ ( ( x - x_mean ) ^ 2 )

结果k若为正值即表示液面处于上升状态，连续计算 k ，用新计算的 k 的绝对值减去上一段 k 的绝对值，如果差值过大， 则表示液面上升速度发生突变，结合注入压井液与实际时间的比较，判断是否发生溢流。
